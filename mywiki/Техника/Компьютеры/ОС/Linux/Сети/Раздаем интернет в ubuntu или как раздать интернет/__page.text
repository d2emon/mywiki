!! Раздаем интернет в ubuntu или как раздать интернет

Меня часто спрашивают начинающие линуксоиды, по какой то причине не очень желающие разбираться с премудростями истинного администрирования, чтения манов и хау-то, как раздать интернет с моей Linux к примеру в домашнюю сеть. 

Attach:images.jpg

Отвечаю. Все очень просто. Необходимо реализовать так называемый NAT.

Реализовывать можно как в ручную так и с помощью скрипта, вот кстати и он:

@@
# Включаем форвардинг пакетов из одного сетевого интерфейса в другой ( сколько бы их не было)
echo 1 > /proc/sys/net/ipv4/ip_forward
#Для реализации NAT нужена программа под названием  iptables, проверьте есть ли она у вас и где она расположена

# which iptables
/sbin/iptables
@@Attach:images

Как раз то что нужно.

@@
# Указываем интерфейс смотрящий в интернет (в нашем случае это eth0 )
/sbin/iptables –table nat –append POSTROUTING –o eth0 -j MASQUERADE
# Указываем интерфейс смотрящий в LAN
/sbin/iptables –append FORWARD –o eth1 -j ACCEPT
###
@@

Также  эти строки можно поместить в 1 файл, к примеру NAT.sh, положить его в каталог пользователя ROOT и сделать его исполняемым ‘chmod 755 ‘. Вот его содержимое:

@@
#!/bin/sh
echo 1 > /proc/sys/net/ipv4/ip_forward
/usr/sbin/iptables –append FORWARD –o eth0 -j ACCEPT
/usr/sbin/iptables –table nat –append POSTROUTING –o eth1 -j MASQUERADE
@@

Если вы хотите чтобы этот скрипт запускался при старте системы, поместите ссылку на него в файл

@@
# echo «/root/NAT.sh >> /etc/rc.local »
@@

После чего настройте сетевое соединение у клиента вашей локальной сети указав правильные IP/Netmask/GW, а так же DNS. Не помните DNS вашего провайдера? Используйте публичные к примеру от Google их адреса просто запомнить 8.8.8.8 и 8.8.4.4.

Вот в принципе и всё.