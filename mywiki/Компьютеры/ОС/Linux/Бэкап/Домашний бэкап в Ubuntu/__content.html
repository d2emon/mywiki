<!DOCTYPE html>
<HTML>
<HEAD>
	<META HTTP-EQUIV='CONTENT-TYPE' CONTENT='TEXT/HTML; CHARSET=UTF-8'/>

	<STYLE type="text/css">
		body, div, p, table {
			font-size:10pt;
			font-family:Verdana;
		}

		img{border:none}
		
	</STYLE>
	
</HEAD>

<BODY>
<P>
<H1>Домашний бэкап в Ubuntu</H1></P>

<P>Утилит для создания бэкапов под Windows написано великое множество — от простейших наколенных поделок до настоящих монстров. А что делать начинающим пользователям Ubuntu? Ну что же, давайте рассмотрим несколько простых в настройке программ для домашнего бэкапа</P>

<P>Материал приведен исключительно в ознакомительных целях. Если же вы собираетесь воспроизводить действия, описанные ниже, настоятельно советуем внимательно прочитать статью до конца хотя бы один раз. Редакция 3DNews не несет никакой ответственности за любые возможные последствия.</P>

<P>Программ для резервного копирования в среде Linux действительно не так уж много. Часть из них для домашнего использования не очень пригодна, так как они не всегда просты в настройке, хоть и позволяют делать резервное копирование и архивацию сотен серверов. Но нам ведь нужно всего ничего — надёжно сохранить свои файлы. По-хорошему, все важные данные должны храниться отдельно от системы, а ещё лучше — на другом физическом диске. Что касается самой ОС, то, как правило, нужно делать бэкапы для корневых каталогов home да etc и изредка некоторые подкаталоги из var или usr/local. Идеальный вариант — регулярное снятие образа всей системы. Впрочем, начать стоит хотя бы с документов. Нам даже не придётся устанавливать дополнительное ПО, так как в последней версии Ubuntu по умолчанию ставится утилита Déjà Dup. Ей-то мы и займёмся.</P>

<P>
<H2>Déjà Dup</H2></P>

<P>Эта программа играет роль стандартной системы резервного копирования (наподобие той, что встроена в Windows 7), начиная с Ubuntu 11.10. К сожалению, многие пользователи не то что не хотят ставить какие-то дополнительные утилиты для бэкапа, но и встроенными в ОС возможностями не пользуются. Как правило, до первой серьёзной потери своих данных. Немного спасают сервисы облачной синхронизации данных. В них можно хранить и резервные копии для пущей надёжности. По умолчанию Déjà Dup использует для этих целей Ubuntu One, в котором бесплатно даётся 5 Гбайт.
<BR> 
<BR>Чтобы включить Déjà Dup, кликните по значку с шестерёнкой в правом верхнем углу основной панели, выберите пункт «Параметры системы…» и перейдите в раздел «Резервное копирование» — это и есть настройки Déjà Dup. В разделе «Носитель» указывается то место, куда будут складываться резервные копии. Утилита умеет копировать данные на FTP, SFTP, ресурсы WebDAV, в общую папку Windows (SMB) или же в любой каталог на локальной машине, а он, в свою очередь, вполне может принадлежать, например, Dropbox.
<BR> 
<BR>Пользователь волен добавить свои папки, которые попадут в архив, а также исключить ненужные каталоги. Можно включить автоматическое резервирование и задать срок хранения архивов. После окончания настройки рекомендуется сделать первую копию самостоятельно, а потом включить автоматический бэкап. Если вы выбрали хранение копий в Ubuntu One, то вас попросят авторизоваться. Также резервные копии можно защитить паролем. Обратите внимание, что Déjà Dup создаёт инкрементальные бэкапы, то есть сохраняются только изменённые с последнего момента синхронизации файлы.
<BR> 
<BR>Для хранения данных в облаках Amazon S3 или Rackspace надо дополнительно установить пакеты python-boto и python-rackspace-cloudfiles. Оба можно найти в «Центре приложений Ubuntu». Для восстановления файлов из резервной копии надо снова обратиться к разделу «Резервное копирование» в параметрах системы. Нас спросят, откуда мы будем восстанавливать данные, предложат выбрать дату и время нужного бэкапа, а также указать папку, куда будут скопированы резервные копии.
<BR> 
<BR>Чуть интереснее выглядят другие возможности Déjà Dup — восстановление удалённых файлов и откат к предыдущим версиям файла. Обе они интегрированы в стандартный файловый менеджер и доступны в меню «Файл» и «Правка» соответственно. Для того чтобы ими воспользоваться, надо перейти в нужную директорию или выбрать необходимый файл. Естественно, для работы этих функций должны иметься резервные копии, из которых и будет происходить восстановление или откат.
<BR> 
<H2>Back In Time</H2></P>

<P>Если вам нужна чуть большая гибкость в настройке бэкапов, то можно воспользоваться утилитой Back In Time. Установить её можно всё в том же центре приложений, где вы найдёте версии GUI для KDE и GNOME. После установки появятся два ярлыка для запуска программы — c root-правами и без них. Первый вариант нужен только при работе с папками, к которым у вас нет прав доступа. При первом запуске откроется окно настроек. Утилита позволят создавать несколько профилей с различающимися настройками. Для начала надо будет указать каталог, куда будут сохраняться резервные копии, и частоту их создания. Затем выбрать сохраняемые папки и файлы, а также исключения. Для исключений можно задавать шаблоны имени файла или папки.</P>

<P>Главная же фишка Back In Time — это умное управление архивами с резервными копиями. Она также делает инкрементальные бэкапы. Автоматическое удаление архивов можно настроить так, чтобы у вас всегда были копии за разные периоды времени, но при этом место на накопителе не тратилось впустую. Среди прочих полезных опций стоит отметить возможность отслеживать изменения в файлах путём подсчёта хеш-сумм. Только учтите, что при большом числе часто меняющихся данных, а в особенности если эти данные присутствуют в виде очень больших файлов, данная опция будет создавать серьёзную нагрузку на систему.</P>

<P>Ну а дальше всё просто — утилита будет сама создавать бэкапы. Можно, конечно, и самому в любой момент запустить процесс резервного копирования. Все копии отображаются в виде списка в левой части окна — выбираете любую и восстанавливаете файлы и папки из неё. Back In Time по сути является удобной надстройкой над rsync. Если вам не нужны все её возможности, то используйте утилиты попроще и без автоматизации. Например, GRsync.</P>

<P>
<H2>Duplicati</H2></P>

<P>Эта кроссплатформенная утилита умудряется несколько чужеродно выглядеть во всех трёх ОС — Windows, Linux, Mac OS. Впрочем, на основных функциях это не сказывается. В стандартных репозиториях её нет, поэтому придётся скачать deb-пакет для Ubuntu и вручную установить его. Первый запуск сопровождается появлением мастера настройки бэкапа. Как обычно, нам предлагают задать его имя, выбрать резервируемые папки и файлы. Для пущей безопасности все архивы можно зашифровать в AES-256 и сгенерировать случайный и надёжный пароль. Он хоть и сохраняется в настройках программы, но всё равно нелишним будет записать его куда-нибудь.
<BR> 
<BR>Главная ценность Duplicati — это возможность сохранять архивы во множестве облачных сервисов, а точнее работа с API самых популярных из них и их совместимых клонов. Мы уже когда-то рассматривали использование Amazon S3 в качестве файлохранилища при работе в Windows. В качестве примера настроим Duplicati для работы с этим облаком. Нам нужны ключи доступа (Access Keys), которые можно найти в разделе Security Credentials вашего аккаунта. Копируем их в соответствующие поля, выбираем имя для нового bucket, регион размещения и, если хочется, включаем использование RRS. Нажимаем Test Connection и соглашаемся с переименованием bucket.
<BR> 
<BR>Помимо облачных сервисов для хранения данных, Duplicati может использовать локальные папки и FTP/SFTP/WebDAV-ресурсы, а также крайне любопытную распределённую P2P-файловую систему Tahoe-LAFS. Дальнейшие настройки профиля бэкапа — а именно: частота создания резервных копий и их тип (инкрементальные и/или полные), автоудаление старых копий, ограничения на занимаемую ширину канала и размеры файлов архива — совпадают для любого типа хранилища. Временные интервалы в этих параметрах указываются в секундах.
<BR> 
<BR>Для резервирования можно выбирать отдельные папки и файлы или, наоборот, исключать часть из них. В качестве шаблона для их имён не возбраняется использовать регулярные выражения. После завершения работы мастера откроется основное окно программы, где надо будет перейти в настройки (Options) и на первой вкладке указать в качестве используемого языка English, иначе в системах с русской локалью могут возникнуть некоторые проблемы. На вкладке SSH укажите путь до SFTP (/usr/bin/sftp).
<BR> 
<BR>Дальнейшая работа с утилитой сводится к запуску мастера, который поможет создать новый профиль для бэкапа, отредактировать или удалить уже имеющиеся профили, а также запустить процесс восстановления данных из резервной копии или же ручного создания оной. Опции восстановления стандартны — выбор профиля, даты и времени архива, отдельных файлов и папок, а также места, куда они будет восстановлены. Рекомендуем попробовать Duplicati обладателям не только Linux, но и других ОС.
<BR> 
<H2>Simple Backup</H2></P>

<P>В конце упомянем ещё об одной простой и полезной программе, название которой говорит само за себя. В принципе, можно оставить все её настройки по умолчанию, выставив только периодичность создания бэкапов. Как и все остальные участники нашего мини-обзора, она может сжимать резервные копии и сохранять удалённо и локально, «по-умному» удалять устаревшие архивы, исключать файлы и папки по шаблонам и путям, поддерживает профили и так далее. Simple Backup также является надстройкой над rsync.
<BR> 
<H2>APTonCD</H2></P>

<P>Ну и напоследок расскажем о стандартной программе, которая позволяет сделать резервную копию установленного в системе ПО, а не пользовательских файлов. Утилита выполнена в виде простого мастера, на первом этапе которого предлагается создать архив (а фактически ISO-образ) или восстановить данные. Затем надо отметить нужные пакеты и при желании добавить к ним другие deb-файлы или папки с ними, а затем выбрать тип носителя (CD или DVD) и отметить галочкой опцию создания метапакета. После этого APTonCD немного подумает, скопирует и каталогизирует необходимые файлы, создаст ISO-образ и тут же предложит записать его на диск.
<BR> 
<BR>Для восстановления всех пакетов сразу достаточно вставить диск на другом ПК или скопировать с него все файлы и открыть пакет aptoncd-metapackage, который находится в каталоге packages. Если на другой машине уже установлен APTonCD, то можно восстановить часть пакетов с помощью самой утилиты, предварительно установив hal (см. команду ниже). Они будут скопированы в кеш APT, то есть для их установки не потребуется доступ в Сеть. На будущее диск с пакетами можно добавить в источники для установки в разделе «Параметры системы» → «Источники приложений», где на вкладке «Другое ПО» надо кликнуть по кнопке «Добавить том…».</P>

<P><CODE>
<BR>sudo apt-get install hal
<BR></CODE> </P>

<P>На этом наш краткий экскурс в системы резервного копирования для Ubuntu будем считать законченным. Мы умышленно исключили системы вроде знаменитой bacula, так как домашним пользователям они не подходят по множеству причин. Надеемся, что наши читатели будут всегда делать регулярные бэкапы и соблюдать элементарные правила «компьютерной гигиены». Тогда и восстанавливать в панике бесценные данные не придётся практически никогда. Удачи!</P>
</BODY>
</HTML>