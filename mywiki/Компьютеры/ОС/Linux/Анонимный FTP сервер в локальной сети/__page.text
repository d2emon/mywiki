!! Анонимный FTP сервер в локальной сети

Установил pure-ftpd - работает, прочитал ман по нему - думаю с настройкой разберусь.

Однако, прежде чем нырять в глубь кастомайза хочется решить несколько оргвопросов, описываю ситуацию:

# есть жёсткий диск (160 Гб, Maxtor) со S.M.A.R.T. статусом bad. Windows на нём умирает с нехорошей периодичностью, в то же время swap и /home патиции в дальних секторах чувствуют себя не плохо.
# есть два контент-дающих раздела (на разных дисках, итого в системе - 3 шт.) /mnt/data с подразделами video, music, books и т.д. - всё более-менее отсортированно, названия поправлены и осмысленны, музыка тэгированна и utf'нута - и /mnt/torrents: периодически расчищаемая файлопомойка.

В голову идут следующие варианты организации фтп-сервера:

# загрузиться с диска Victoria, посмотреть что скажет Вика, попробовать сделать ремапинг Макстора, разбить его на два-три ext3 раздела и примонтировать в /home/ftp[[<<]]Тогда можно особо не парясь накидать туда файлов на раздачу и задать всем нужные параметры доступа.[[<<]]Из минусов - не факт, что получится диск реанимировать, да и потом всё время ожидать его падения.
# создать папку /home/ftp и сделать сим-линки на /mnt/torrents/downloaded и нужные разделы /mnt/data

Здесь есть пока несколько непонятностей:

# будет ли торрент клиент блокировать раздачу фтп-клиента и наоборот?
# смогут ли анонимусы по сим-линкам директорий войти в эти директории и увидеть все доступные файлы?
# если поставить на сим-линки атрибут "только для чтения", будут ли файлы в директориях доступны анонимусам только для чтения?
# стоит ли заводить нового пользователя upload и не выпускать его за границы ~upload или сделать anonimous-only фтп-сервер?
# как быть с новыми файлами, добавляемыми в /mnt/torrents/downloaded (автоматически) и /mnt/data (вручную), будут ли они read-only, если работают пункты б.) и в.) ?

Очень не хотелось бы оставить дыр в системе и в один прекрасный момент потерять все файлы.

/mnt/torrents не так жалко, большая часть в /mnt/data скопирована, а вот информацию из второй директории дорожу, хотя ею и удобнее всего делиться.

----

Сервер настроил, работает. Правда, перешёл на proftpd.

Но есть проблема, кусок конфига в качестве иллюстрации:

Код:
@@
&lt;Anonymous /mnt/data/ftp&gt;
User anonymous
Group anonymous
AnonRequirePassword off
MaxClients 5 "The server is full, hosting %m users"
DisplayLogin welcome.msg
&lt;Limit LOGIN&gt;
Allow from all
Deny from all
&lt;/Limit&gt;
&lt;Limit LIST NLST  RETR  PWD XPWD  SIZE  STAT  CWD XCWD  CDUP XCUP &gt;
AllowAll
&lt;/Limit&gt;
&lt;Limit STOR STOU  APPE  RNFR RNTO  DELE  MKD XMKD SITE_MKDIR  RMD XRMD SITE_RMDIR  SITE  SITE_CHMOD  SITE_CHGRP  MTDM &gt;
DenyAll
&lt;/Limit&gt;
&lt;Directory /mnt/data/video/anime&gt;
&lt;Limit LIST NLST  RETR  PWD XPWD  SIZE  STAT  CWD XCWD  CDUP XCUP &gt;
AllowAll
&lt;/Limit&gt;
&lt;Limit STOR STOU  APPE  RNFR RNTO  DELE  MKD XMKD SITE_MKDIR  RMD XRMD SITE_RMDIR  SITE  SITE_CHMOD  SITE_CHGRP  MTDM &gt;
DenyAll
&lt;/Limit&gt;
&lt;/Directory&gt;
&lt;/Anonymous&gt;
@@

* /mnt/data/ftp - основная папка, анонимус её видит и может качать.
* /mnt/data/video - дополнительная, её анонимус не видит- а очень хотелось бы.

Тупо дублировать в /mnt/data/ftp то что в соседней директории лежит совсем неохота.

----

* создаёшь новую папку xxx где угодно
* вместо "&lt;Anonymous /mnt/data/ftp&gt;" путь к ней &ltAnonymous /xxx&gt;
* в ней делаешь пустые ftp и video
* монтируешь настоящие ftp и video в эти пустые
* * mount --bind /mnt/data/ftp /xxx/ftp
* * mount --bind /mnt/data/video /xxx/video
* чтоб монтирование сохранялось после ребута - правишь /etc/fstab
* дописываешь строки в виде
[@
/mnt/data/ftp    /xxx/ftp      vfat     bind     0     0   
@]

----

И в догонку свой вопрос... по теме вроде =) 

долго я бился с proftpd и gProftpd ... настраивал и кодировки utf8-cp1215, и монтирование то самое, и код конфига, и автозапуск в системе... 

вообщем чувствую что совсем не много осталось до победного конца :) 

 :coolsmiley: к делу:

7.10 desktop + proftpd + gProftpd + ssh = используется чисто как ftp сервак в локалке

в системе 4 пользователя: 

* root
* dimana - основной пользователь, что при установке прописывается
* admin - хочу что бы администрировал файлы на ftp сервере удалённо через фтп-клиенты
* anonymous - доступ к серверу без пароля

честно говоря, запутался совершенно в итоге с правами и группами. 

задача - что бы admin мог удалять, править, перетаскивать  файлы , закачанные на сервер под анонимусом (по умолчанию ставятся 644)

в каких группах должен состоять admin, root ? от чьего имени работать proftpd ? может я что ещё упускаю?

----


Думаю, всё решается группами.

ведь права 644 ... с 4кой на группе