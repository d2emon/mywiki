jQuery.autocomplete=function(k,e,B){var C=this,f=$(k).attr("autocomplete","off"),l=document.createElement("div"),g=$(l);g.hide().addClass("ac_results").css("position","absolute");$("body").append(l);k.autocompleter=C;var h=null,u="",i=-1,j={},v=true,s=null;j.data={};f.keydown(function(a){s=a.keyCode;switch(a.keyCode){case 38:a.preventDefault();w(-1);break;case 40:a.preventDefault();w(1);break;case 9:case 13:D();break;default:i=-1;h&&clearTimeout(h);h=setTimeout(function(){E()},1);break}}).focus(function(){v=
true}).blur(function(){v=false;F()});p();function E(){if(f.parents("form").find(":input[name=search_type]").val()!="title")return true;if(s==46||s>8&&s<32)return g.hide();var a=f.val().toLowerCase();if(a!=u){u=a;a.length?G(a):g.hide()}return true}function w(a){var b=$("li",l).not(".in_artist_title");if(b){i+=a;if(i<0)i=0;else if(i>=b.size())i=b.size()-1;b.removeClass("ac_over");$(b[i]).addClass("ac_over")}}function D(){var a=$("li.ac_over",l)[0];if(a){x(a);return true}else return false}function x(a){if(a){a=
$(a).text();u=k.lastSelected=a;g.html("");f.val(a);p()}}function I(){var a={width:$(".searchinp").outerWidth()-2,top:$(".searchinp").offset().top+$(".searchinp").outerHeight(),left:$(".searchinp").offset().left};if($(".searchsel").length){a.left-=1;a.width+=1;a.top-=1}if(!$(".searchinp").length){a.left=f.offset().left;a.width=f.outerWidth();a.top=f.offset().top+f.outerHeight()}g.css(a).show()}function F(){h&&clearTimeout(h);h=setTimeout(p,200)}function p(){h&&clearTimeout(h);g.is(":visible")&&g.hide()}
function y(a,b){if(b){l.innerHTML="";if(!v||b.length==0)return p();$.browser.msie&&g.append(document.createElement("iframe"));l.appendChild(J(a,b));I()}else p();return false}function J(a,b){var c=document.createElement("ul"),d,z=true;if(e&&b[0].substr(-1,1)=="@"){d=document.createElement("li");d.innerHTML="In "+B+":";$(d).addClass("in_artist_title");c.appendChild(d)}for(var m=0;m<b.length;m++){d=document.createElement("li");if(b[m].substr(-1,1)=="@"){var t=a.split(" ");d.selectValue=b[m].substr(0,
b[m].length-1);for(var n=d.selectValue.split(" "),q=0;q<t.length;q++)for(var o=0;o<n.length;o++)if(n[o].toLowerCase().indexOf(t[q].toLowerCase())===0)n[o]="<span>"+n[o].slice(0,t[q].length)+"</span>"+n[o].slice(t[q].length);d.innerHTML=n.join(" ")}else{if(e&&z){z=false;$(d).addClass("not_art")}d.selectValue=d.innerHTML=b[m]}c.appendChild(d);$(d).hover(function(){$("li",c).removeClass("ac_over");$(this).addClass("ac_over");i=$("li",c).indexOf($(this).get(0))},function(){$(this).removeClass("ac_over")}).click(function(A){A.preventDefault();
A.stopPropagation();x(this);f.parents("form").submit()})}return c}var r=false;function G(a){var b=K(a);if(b)y(a,b);else{H=document.getElementsByTagName("body")[0];r&&H.removeChild(r);r=document.createElement("script");r.src=e?"http://www.ultimate-guitar.com/search/suggest.php?q="+encodeURI(a)+"&artist="+e:"http://www.ultimate-guitar.com/search/sug/"+a.slice(0,1)+"/"+encodeURI(a)+".js";H.appendChild(r)}}function K(a){if(j.data[a])return j.data[a];for(var b=false,c=a;c.length>1&&!j.data[c];){c=c.slice(0,
-1);if(j.data[c])b=j.data[c].length<10}if(b){b=j.data[c];c=[];for(var d=0;d<b.length;d++)if(b[d].charAt(b[d].length-1)=="@"){if(L(a,b[d]))c[c.length]=b[d]}else if(b[d].toLowerCase().indexOf(a)==0)c[c.length]=b[d];return c}return null}function L(a,b){a=a.split(" ");b=" "+b;for(var c=0;c<a.length;c++)if(b.indexOf(" "+a[c])<0)return false;return true}this.receiveData=function(a,b){y(a,b);j.data[a]=b}};
jQuery.fn.autocomplete=function(k,e){this.each(function(){window.auto=new jQuery.autocomplete(this,k,e)});return this};jQuery.fn.indexOf=function(k){for(var e=0;e<this.length;e++)if(this[e]==k)return e;return-1};
